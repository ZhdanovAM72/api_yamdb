# Групповой проект YaMDb.

##### Проект YaMDb собирает отзывы пользователей на произведения.Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
####
##### Произведения делятся на категории, такие как «Книги», «Фильмы», «Музыка». Например, в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Жуки» и вторая сюита Баха. Список категорий может быть расширен (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»).
####
##### Произведению может быть присвоен жанр из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»).
####
##### Добавлять произведения, категории и жанры может только администратор.
Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.
######
##### Пользователи могут оставлять комментарии к отзывам.
Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.


## Команда разработчиков:
- [Александр Жданов (тимлид, в роли первого разработчика)](https://github.com/ZhdanovAM72)
- [Зольников Юрий (в роли второго разработчика)](https://github.com/Kolbacyn)
- [Жанна Ивашова (в роли третьего разработчика)](https://github.com/ZhannaIvashova)


## Ресурсы API YaMDb:
- Ресурс **auth**: аутентификация.
- Ресурс **users**: пользователи.
- Ресурс **titles**: произведения, к которым пишут отзывы (определённый фильм, книга или песенка).
- Ресурс **categories**: категории (типы) произведений («Фильмы», «Книги», «Музыка»). - Одно произведение может быть привязано только к одной категории.
- Ресурс **genres**: жанры произведений. Одно произведение может быть привязано к нескольким жанрам.
- Ресурс **reviews**: отзывы на произведения. Отзыв привязан к определённому произведению.
- Ресурс **comments**: комментарии к отзывам. Комментарий привязан к определённому отзыву.


## Применяемые в проекте технологии:

- Python v3.9.6
- Django v3.2
- Django Rest Framework v3.12.4
- PyJWT v2.1.10
- DRF SimpleJWT v5.2.2

## Пользовательские роли:
Аноним, Аутентифицированный пользователь, Модератор, Администратор, Суперюзер.

Реализована самостоятельная регистрация пользователей через эндпоинт /api/v1/auth/signup/ с последующим получением JWT-токена.

## Запуск проекта:

1. Cоздать и активировать виртуальное окружение:
```
Unix:
python3 -m venv venv source venv/bin/activate

Windows:
python -m venv venv source venv/Scripts/activate
```
2. Обновить PIP:
```
pip install --upgrade pip
```
3. Установить зависимости из файла requirements.txt:
```
pip install -r requirements.txt
```
4. Выполнить миграции (из дирректории с файлом manage.py):
```
python manage.py migrate
```
5. Запустить проект (из дирректории с файлом manage.py):
```
python manage.py runserver
```
6. Загрузить тестовые данные из csv файла:
```
python manage.py csv_importer
```
7. Документация проекта находится по этому эндпоинту (замените "your_localhost" на свой):
```
http://your_localhost/redoc/
```

## Примеры работы с API для всех пользователей
Для неавторизованных пользователей работа с API доступна в режиме чтения, что-либо изменить или создать не получится.

```r
Права доступа: Администратор
GET /api/v1/users/ - Получение списка всех пользователей

Права доступа: Доступно без токена.
GET /api/v1/categories/ - Получение списка всех категорий
GET /api/v1/genres/ - Получение списка всех жанров
GET /api/v1/titles/ - Получение списка всех произведений
GET /api/v1/titles/{title_id}/reviews/ - Получение списка всех отзывов
GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/ - Получение списка всех комментариев к отзыву
```

## Регистрация нового пользователя
##### Получить код подтверждения на переданный email. Права доступа: Доступно без токена. Использовать имя 'me' в качестве username запрещено. Поля email и username должны быть уникальными.

#### Получение JWT-токена в обмен на username и confirmation code.
```http
POST /v1/auth/signup/ - Права доступа: Доступно без токена.
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `username` | `string` | **Required**. Имя пользователя |
| `email` | `string` | **Required**. email пользователя |


#### Получение токена для доступа к API
```http
POST /v1/auth/token/ - Права доступа: Доступно без токена.
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`      | `string` | **Required**. Имя пользователя |
| `confirmation_code`      | `string` | **Required**. Код подтверждения (полученый на email) |

### Категории (типы) произведений
#### Получить список всех категорий 
```http
GET /api/v1/categories/ - Права доступа: Доступно без токена
```

#### Добавление категории:
```http
POST /api/v1/categories/ - Доступ: Администратор.
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `name`      | `string` | **Required**. Имя категории |
| `slug`      | `string` | **Required**. Slug категории |

#### Удаление категории:
```http
DELETE /api/v1/categories/{slug} - Доступ: Администратор.
```

#### Получить список всех жанров. 
```http
GET /api/v1/genres/ - Права доступа: Доступно без токена
```

#### Добавить жанр. 
- Поле slug каждого жанра должно быть уникальным.
```http
POST /api/v1/genres/ - Права доступа: Администратор. 
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `name`      | `string` | **Required**. Имя жанра |
| `slug`      | `string` | **Required**. Slug жанра |

#### Удаление жанра:
```http
DELETE /api/v1/genres/{slug} - - Доступ: Администратор.
```
### Произведения, к которым пишут отзывы (определённый фильм, книга или песенка).

#### Получить список всех произведений.
```http
GET /api/v1/titles/ - Права доступа: Доступно без токена
```

#### Добавить новое произведение.
- Нельзя добавлять произведения, которые еще не вышли (год выпуска не может быть больше текущего). При добавлении нового произведения требуется указать уже существующие категорию и жанр.
```http
POST /api/v1/titles/ - Права доступа: Администратор.
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `name`      | `string` | **Required**. Произведения |
| `year`      | `integer` | **Required**. Год |
| `description`      | `string` | Описание |
| `genre`      | `string` | Жанр |
| `category`      | `string` |  Котегория |

#### Информация о произведении.
- Нельзя добавлять произведения, которые еще не вышли (год выпуска не может быть больше текущего). При добавлении нового произведения требуется указать уже существующие категорию и жанр.
```http
GET /api/v1/titles/{titles_id}/ - Права доступа: Администратор.
```

#### Обновить информацию о произведении.
```http
PATCH /api/v1/titles/{titles_id}/ - Права доступа: Администратор.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `titles_id`      | `integer` | **Required**. Произведения |

#### Удалить произведение.
```http
DELETE /api/v1/titles/{titles_id}/ - Права доступа: Администратор.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `titles_id`      | `integer` | **Required**. Произведения |

### Отзывы
#### Получить список всех комментариев к отзыву по id.
```http
GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/ - Права доступа: Доступно без токена.
```

#### Добавить новый комментарий для отзыва.
```http
POST /api/v1/titles/{title_id}/reviews/{review_id}/comments/ - Права доступа: Аутентифицированные пользователи.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `titles_id`      | `integer` | **Required**. ID произведения |
| `review_id`      | `integer` | **Required**. ID отзыва |

#### Получить комментарий для отзыва по id..
```http
GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/ - Права доступа: Доступно без токена.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `titles_id`      | `integer` | **Required**. ID произведения |
| `review_id`      | `integer` | **Required**. ID отзыва |
| `comment_id`      | `integer` | **Required**. ID комментария |

#### Частично обновить комментарий к отзыву по id.
```http
PATCH /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/ - Права доступа: Автор комментария, модератор или администратор.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `titles_id`      | `integer` | **Required**. ID произведения |
| `review_id`      | `integer` | **Required**. ID отзыва |
| `comment_id`      | `integer` | **Required**. ID комментария |

#### Удалить комментарий к отзыву по id.
```http
DELETE /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/ - Права доступа: Автор комментария, модератор или администратор.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `titles_id`      | `integer` | **Required**. ID произведения |
| `review_id`      | `integer` | **Required**. ID отзыва |
| `comment_id`      | `integer` | **Required**. ID комментария |

### Пользователи
#### Получить список всех пользователей.
```http
GET /api/v1/users/ - Права доступа: Администратор
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `search`      | `string` | Поиск по имени пользователя (username) |

#### Добавить нового пользователя. 
```http
POST /api/v1/users/ - Права доступа: Администратор Поля email и username должны быть уникальными.
```
Пример:
```
{
  "username": "6FYPl2UJHyBL.6r@XDrpFynuutIe2um+hv1ybTjB-vdxz",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```
#### Получить пользователя по username.
```http
GET /api/v1/users/{username}/ - Права доступа: Администратор
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`      | `string` | **Required**. Username пользователя |

#### Изменить данные пользователя по username.
```http
PATCH /api/v1/users/{username}/ - Права доступа: Администратор. Поля email и username должны быть уникальными.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`      | `string` | **Required**. Username пользователя |

#### Удалить пользователя по username.
```http
DELETE /api/v1/users/{username}/ - Права доступа: Администратор.
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`      | `string` | **Required**. Username пользователя |

#### Получить данные своей учетной записи.
```http
GET /api/v1/users/me/ - Права доступа: Любой авторизованный пользователь
```
Пример ответа API:
```
{
  "username": "vF+d1l2Rw6OlgWDz",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```

#### Изменить данные своей учетной записи.
```http
PATCH /api/v1/users/me/ - Права доступа: Любой авторизованный пользователь
```
Пример тела запроса:
```
{
  "username": "5krHWYegCM+4FP1Sz",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string"
}
```
